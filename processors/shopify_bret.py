# processors/shopify_jon.py
from .shopify_common import process as shopify_process

def process(df):
    """Shopify processing for John with additional customization"""
    # First apply common Shopify processing
    df['Shipping Zip'] = df['Shipping Zip'].str.replace("^'", "", regex=True)
    zip = [
    # Travis County
    '73301', '73344', '78701', '78702', '78703', '78704', '78705', '78708', '78709', '78710', 
    '78711', '78712', '78713', '78714', '78715', '78716', '78717', '78718', '78719', '78720', 
    '78721', '78722', '78723', '78724', '78725', '78726', '78727', '78728', '78729', '78730', 
    '78731', '78732', '78733', '78734', '78735', '78736', '78737', '78738', '78739', '78741', 
    '78742', '78744', '78745', '78746', '78747', '78748', '78749', '78750', '78751', '78752', 
    '78753', '78754', '78755', '78756', '78757', '78758', '78759', '78760', '78761', '78762', 
    '78763', '78764', '78765', '78766', '78767', '78768', '78769', '78772', '78773', '78774', 
    '78778', '78779', '78783', '78799',

    # Hays County
    '78610', '78619', '78620', '78623', '78640', '78656', '78666', '78667', '78676', '78736', 
    '78737', '78738', '78748', '78766',

    # Bell County
    '76501', '76502', '76503', '76504', '76505', '76508', '76511', '76513', '76519', '76520', 
    '76528', '76534', '76540', '76541', '76542', '76543', '76544', '76545', '76546', '76547', 
    '76548', '76549', '76554', '76557', '76559', '76564', '76569', '76571', '76579',

    # Bexar County
    '78023', '78039', '78052', '78054', '78056', '78059', '78064', '78069', '78073', '78101', 
    '78109', '78112', '78148', '78150', '78152', '78154', '78155', '78163', '78201', '78202', 
    '78203', '78204', '78205', '78206', '78207', '78208', '78209', '78210', '78211', '78212', 
    '78213', '78214', '78215', '78216', '78217', '78218', '78219', '78220', '78221', '78222', 
    '78223', '78224', '78225', '78226', '78227', '78228', '78229', '78230', '78231', '78232', 
    '78233', '78234', '78235', '78236', '78237', '78238', '78239', '78240', '78241', '78242', 
    '78243', '78244', '78245', '78246', '78247', '78248', '78249', '78250', '78251', '78252', 
    '78253', '78254', '78255', '78256', '78257', '78258', '78259', '78260', '78261', '78262', 
    '78263', '78264', '78265', '78266', '78268', '78269', '78270', '78275', '78278', '78279', 
    '78280', '78283', '78284', '78285', '78286', '78287', '78288', '78289', '78291', '78292', 
    '78293', '78294', '78295', '78296', '78297', '78298', '78299',

    # Blanco County
    '78606', '78635', '78636', '78654', '78663', '78669', '78671', '78675', '78676',

    # Burnet County
    '76527', '76537', '76549', '76550', '76567', '76599', '78605', '78608', '78611', '78613', 
    '78639', '78641', '78642', '78643', '78654', '78657',

    # Caldwell County
    '78616', '78622', '78632', '78640', '78644', '78648', '78655', '78656', '78661', '78662', 
    '78670',

    # Comal County
    '78006', '78015', '78070', '78108', '78130', '78131', '78132', '78133', '78135', '78163', 
    '78266', '78606', '78623',

    # Gillespie County
    '78028', '78058', '78618', '78624', '78631', '78635', '78636', '78671', '78675',

    # Guadalupe County
    '78108', '78115', '78121', '78123', '78124', '78130', '78132', '78140', '78148', '78150', 
    '78154', '78155', '78156', '78638', '78648', '78655', '78666', '78670',

    # Lee County
    '76567', '76578', '77853', '77857', '78616', '78621', '78650', '78659', '78941', '78942', 
    '78945', '78946', '78947',

    # Llano County
    '76831', '76869', '76885', '78607', '78609', '78611', '78624', '78639', '78643', '78657', 
    '78663',

    # Kendall County
    '78004', '78006', '78013', '78015', '78027', '78070', '78074', '78624', '78636', '78070',

    # Milam County
    '76511', '76518', '76519', '76520', '76523', '76527', '76530', '76534', '76556', '76567', 
    '76569', '76570', '76577', '76578', '77859',

    # Williamson County
    '76511', '76527', '76530', '76537', '76571', '76573', '76574', '76577', '76578', '76579', 
    '78605', '78613', '78615', '78621', '78626', '78627', '78628', '78633', '78634', '78641', 
    '78642', '78646', '78650', '78660', '78664', '78665', '78673', '78674', '78681', '78682', 
    '78683', '78717', '78718', '78726', '78727', '78728', '78729', '78750', '78759'
    ]

    # Filter the dataset to include only West Coast states
    df = df[df['Billing Zip'].isin(zip)]
    df = shopify_process(df)
    
    return df